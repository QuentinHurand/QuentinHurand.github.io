<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Test de Réflexe</title>
  <style>
    body {
      background-color: #121212;
      color: #ffffff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      text-align: center;
    }

    h1 {
      font-size: 3rem;
      margin-bottom: 20px;
      color: #00ffcc;
    }

    #message {
      font-size: 1.5rem;
      margin-bottom: 20px;
      color: #ffd700;
    }

    #startButton {
      padding: 15px 30px;
      font-size: 1.5rem;
      background-color: #1e90ff;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s;
    }

    #startButton:hover {
      background-color: #00bfff;
    }

    #score {
      margin-top: 30px;
      font-size: 1.2rem;
      color: #aaa;
    }

    #backMenu {
      position: absolute;
      top: 20px;
      left: 20px;
      background-color: #333;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 10px 15px;
      font-size: 1rem;
      cursor: pointer;
    }

    #backMenu:hover {
      background-color: #444;
    }
  </style>
</head>
<body>
  <button id="backMenu" onclick="location.href='index.html'">← Menu</button>
  <h1>⚡ Test de Réflexe</h1>
  <div id="message">Clique sur le bouton quand il devient vert !</div>
  <button id="startButton" disabled>En attente...</button>
  <div id="score">Ton meilleur temps : <span id="bestTime">-</span> ms</div>

  <script>
    const pseudo = "Toi";
    const startButton = document.getElementById("startButton");
    const message = document.getElementById("message");
    const bestTimeSpan = document.getElementById("bestTime");

    let startTime;
    let timeout;

    function loadBestScore() {
      const best = localStorage.getItem("bestScore_" + pseudo);
      if (best) {
        bestTimeSpan.textContent = best;
      } else {
        bestTimeSpan.textContent = "-";
      }
    }

    function setRandomDelay() {
      const delay = Math.floor(Math.random() * 5000) + 2000; // 2 à 7 secondes
      startButton.disabled = true;
      startButton.style.backgroundColor = "#1e90ff";
      message.textContent = "Prépare-toi...";

      timeout = setTimeout(() => {
        startButton.disabled = false;
        startButton.textContent = "Clique !";
        startButton.style.backgroundColor = "green";
        startTime = Date.now();
      }, delay);
    }

    startButton.addEventListener("click", () => {
      if (startButton.disabled) return;

      const reactionTime = Date.now() - startTime;
      message.textContent = `⏱ Temps de réaction : ${reactionTime} ms`;

      // Meilleur score
      const best = localStorage.getItem("bestScore_" + pseudo);
      if (!best || reactionTime < best) {
        localStorage.setItem("bestScore_" + pseudo, reactionTime);
        bestTimeSpan.textContent = reactionTime;
      }

      // Prépare la prochaine tentative
      startButton.textContent = "En attente...";
      startButton.disabled = true;
      startButton.style.backgroundColor = "#1e90ff";
      setTimeout(setRandomDelay, 2000);
    });

    // Lancement initial
    loadBestScore();
    setTimeout(setRandomDelay, 1000);
  </script>
</body>
</html>
